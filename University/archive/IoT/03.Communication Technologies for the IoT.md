# Networking tiny devices
In IoT the entities that needs to communicate are Wearable, Environmental sensor/actuators, Domotic sensors/actuators, White goods(washing machine, ...), Vehicles.
In IIoT the entities that needs to communicate are Higher Layer components among themselves, Controllers with higher layer components (MES, ERP, Data Bases, Data Lakes), Controllers with controllers (PLCs, SCADA), Sensors with controllers (PLCs, DCS). The difference is that most of the time in IoT the communication is wireless meanwhile in IIoT the communication is wired.
## What is the difference between IoT and IIoT?
The area of communication, core of the internet is wired, wireless is only the first link to the network. In IoT you have basically only wireless communication. 
In IoT and wireless scenarios we have:
- Strong electromagnetic interference
- Harsh conditions (temperature, humidity, etc.)
- High mechanical stress
Different Requirements:
- Timeliness
- Determinism
- Reliability
IT/OT Check list to orientate among the different solutions in wired/wireless communication:
- What is the network size?
- Mobile or Fixed Nodes?
- Any service QoS constraint (throughput, latency)?
- The “integration issue”(Common internet stack cannot be used in IoT as there is a capability problem, the smart objects aren't powerful enough)
- Any budget?
So we need to redefine the entire stack protocol for the smart objects.
## What is the traffic in IoT?

- Cyclic Traffic: periodic transfer of sensor measurements and set points(usual traffic inside an IoT application, most of the time the data transfer is very small in volume)
	Example: velocity control loop of a electrical engine requires sending a set point (2 bytes) every 100us
- Acyclic Traffic: traffic generated by unpredictable events(non deterministic traffic. Still small amount of traffic)
	Example: alarm triggered by a failing component of the industrial process
- Multimedia Traffic: images/video, huge amount of traffic, not frequently used inside an IoT application but can be used. Usually is not done in the visible range(use for thermal images, infrared images,...). Usually it is accumulated very slowly(ex: once per day).
	Example: intrusion detection systems, defect inspection
- Backhand Traffic: aggregated flows
## IoT KPIs
### Throughput
**Throughput (rate)**: number of bits (bytes) per second that can be sent across a link (Unit measure: [bit/s] or [byte/s])
 Depends on: link type
                           1 B = 8 bit
1 kbps (kb/s) = 103 bps            1 kB = 103 B
1 Mbps (Mb/s) = 106 bps         1 MB = 106 B
1 Gbps (Gb/s) = 109 bps           1 GB = 109 B
IoT applications have a low throughout(10kB/s-1Mb/s)
Maximum throughput for bluthooth is 3 MB/s
#### Delay KPIs
**Delivery Time**: time necessary to send one service data unit from source to destination (Unit measure: [s])
Depends on: transmission time, propagation time, protocol execution time
Example: link d meters long with a throughput R, source S to send L bits to D, wave propagation speed

![](https://i.imgur.com/PXoMR4C.png)

**Minimum Cycle Time (MCT)**: minimum time required to execute a cycle in a control loop
$$M CT = T_{P LC-S1} + T_{S1-P LC} + T_{PLC-S2} + T_{S2-PLC}$$
Example: one controller, 2 sensors; control loop: PLC polls sensor 1, sensor 1 sends back reading, PLC does the same for sensor 2

![](https://i.imgur.com/q1E76xH.png)
### Precision
**Jitter**: precision/reliability in performing periodic operations
Example: nominal required time to execute a generic control operation, P; actual current time to execute the generic operation $\hat P$: 
$$J=\frac{|P-\hat P|}{P}$$
# A primer on networking fundamentals
## How to Define a Communication Technology?
Physical infrastructure: hosts (sensors/actuators, PLC, SCADA), links (fiber optics, wireless, wired), network nodes (access point, switch, router, gateway)
Network architectures/topologies
A set of communication protocols
These are all structures/protocols required to define a communication technology.

![](https://i.imgur.com/1oOSLOV.png)
## Physical components
Hosts: traffic end points(physical/virtual servers, personal devices, smart objects)
Links: way to transmit information(fibers, twisted pairs, coax cables, wireless)
Network devices: objects that redirect the traffic(router, switch, access point)
## IoT Connectivity: Never (seldom) one single-hop/technology
![](https://i.imgur.com/3MeVAKH.png)

If the application is not closed it will need to communicate over the internet so it needs to translate its messages to the internet protocol. Rare to find in communication to have a single technology that does all the work.
IoT often works in personal space but there could be IoT scenarios that are in the more large scene(WAN, MAN, 100s km in range)

![](https://i.imgur.com/pqnnU2M.png)

Different solutions are characterized by different topologies.

![](https://i.imgur.com/V4jqGfJ.png)
## Communication Protocol
We will also define the communication protocols(rules on how the communication works).
Set of rules underpinning the exchange of information between two entities:
- Message format
- Connection set up procedures
- Connection tear down procedures
- Semantics
IoT comm networks protocols exchange packets (like the Internet)

![](https://i.imgur.com/svK0uiY.png)

In IoT these packets are really small(100s of Byte).
## Layer Architecture
Communication protocols are commonly layered
 Each layer provides some services/funstionalities to upper layers
No standard in the IoT(some are slowly becoming popular but most of the time each communication technology will define its own stack).

![](https://i.imgur.com/uKQlqYn.png)

Unfortunately the communication technologies are fragmented and make us study each layer and packet differently. This implies that we need to analyze each layer separately(we can apply a different solution for each layer). 
- Level 5: Application Layer, data produced by the application
- Level 4: IP layer
- Level 3: Routing layer
- Level 2: 
- Level 1: Physical layer(information on how to decode the bits on the other side)
Each layer will reconstruct the data received by removing headers and using the information to translate the payload.
### Internet Protocol Stack
![](https://i.imgur.com/NQcQ96L.png)
